generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider   = "postgresql"
  url        = env("DATABASE_URL")
  directUrl  = env("DIRECT_URL")
}

model User {
  id          String           @id @default(uuid())
  nama        String           @db.VarChar(100)
  username    String           @unique @db.VarChar(58)
  password    String           @db.VarChar(255)
  role        Role
  is_active   Boolean          @default(true)
  created_at  DateTime         @default(now())
  updated_at  DateTime         @updatedAt

  // Relations
  loginActivities LoginActivity[]  @relation("UserLoginActivities")
  berandaPages    HalamanBeranda[] @relation("UserBerandaPages")
  houseTypes      TypeRumah[]      @relation("UserHouseTypes")

  @@map("user")
}

model LoginActivity {
  id          Int         @id @default(autoincrement())
  userId      String
  tanggal     DateTime    @default(now())
  status      LoginStatus

  // Relations
  user User @relation("UserLoginActivities", fields: [userId], references: [id], onDelete: Cascade)

  @@map("login_activity")
  @@index([userId, tanggal])
  @@index([tanggal])
  @@index([status])
}

model HalamanBeranda {
  id          Int    @id @default(autoincrement())
  gambar      String @db.VarChar(255)
  userId      String

  // Relations
  user User @relation("UserBerandaPages", fields: [userId], references: [id], onDelete: Cascade)

  @@map("halaman_beranda")
}

model TypeRumah {
  id            Int               @id @default(autoincrement())
  namaType      TypeRumahEnum
  harga         Decimal           @db.Decimal(15, 2)
  luasBangunan  String            @db.VarChar(50)
  deskripsi     String            @db.VarChar(255)
  userId        String

  // Relations
  user   User               @relation("UserHouseTypes", fields: [userId], references: [id], onDelete: Cascade)
  images TypeRumahGambar[]  @relation("HouseImages")

  @@map("type_rumah")
  @@index([namaType])
  @@index([harga])
}

model TypeRumahGambar {
  id        Int       @id @default(autoincrement())
  typeId    Int
  gambar    String    @db.VarChar(255)
  urutan    Int       @default(1)

  // Relations
  type TypeRumah @relation("HouseImages", fields: [typeId], references: [id], onDelete: Cascade)

  @@map("type_rumah_gambar")
}

enum Role {
  admin
  marketing
}

enum LoginStatus {
  Success
  Failed
}

enum TypeRumahEnum {
  Type_Luxury
  Type_Premium
  Type_Premium_A
  Type_Premium_B
}
